# Sharpen Commander (sc) 유닛 테스트 케이스 정의

이 문서는 `sc` 프로젝트의 각 기능별로 자동화된 유닛 테스트가 가능한 시나리오를 정리합니다.

## 1. 공통 코어 로직 (AppContext & Utils)
애플리케이션의 설정 관리 및 유틸리티 함수에 대한 테스트입니다.

- **AppContext**
    - [x] `reg_find_by_name`: 대소문자 구분 없이 등록된 이름으로 항목을 올바르게 찾는지 확인
    - [ ] `reg_add`: 새로운 경로 추가 시 `git` 저장소 여부 판별 및 이름 자동 생성 로직 검증
    - [x] `save_path`: `/tmp/cmdDevTool.path` 파일에 경로가 정확히 써지는지 확인 (경로 확장 포함)
- **Utils**
    - [x] `match_disorder`: 검색어 조각들이 순서에 상관없이 대상 문자열에 포함되는지 확인
    - [x] `strip_ansi`: ANSI 색상 코드가 포함된 문자열에서 코드만 정확히 제거되는지 확인
    - [x] `unquote_path`: Git 출력에서 인용부호(`"`)로 감싸진 경로를 올바르게 디코딩하는지 확인 (unwrap_quotes_filename)

## 2. 메인 화면 (MainState)
파일 브라우징 및 필터링 상태 로직을 테스트합니다.

- **필터링 로직**
    - [ ] `refresh`: 필터 문자열 입력 시 해당 글자가 포함된 파일/디렉토리만 `items` 목록에 남는지 확인 (현재 메인화면 필터 기능 제거됨)
    - [ ] `..` (상위 디렉토리) 항목이 항상 목록의 첫 번째(인덱스 0)에 위치하는지 검증
- **탐색 로직**
    - [ ] `enter_dir`: 상위 디렉토리(`..`) 진입 시 현재 경로(`cwd`)가 올바르게 부모 경로로 변경되는지 확인
    - [ ] `select_next/prev`: 목록의 끝이나 시작에서 범위를 벗어나지 않고 인덱스가 유지되는지 확인

## 3. 이동 화면 (Goto Screen)
가장 복잡한 검색 및 정렬 로직이 포함된 부분입니다.

- **검색 및 정렬 우선순위 (Scoring)**
    - [x] `filtered_items`: 
        - [x] 정확히 일치하는 이름이 가장 상단에 오는지 확인
        - [x] 입력어로 시작하는 항목이 중간에 포함된 항목보다 높은 우선순위를 갖는지 확인
        - [x] 여러 단어 입력 시 모든 조각을 포함하는 경로만 필터링되는지 확인
- **최근 방문/즐겨찾기 통합**
    - [ ] 즐겨찾기 목록과 로컬 하위 디렉토리 목록이 중복 없이 합쳐지는지 확인

## 4. Git 상태 화면 (GitStatusState)
Git 출력 결과의 파싱 및 선택 로직을 테스트합니다.

- **항목 생성 (Parsing)**
    - [ ] `build_git_items`: `git status --porcelain` 형태의 가상 데이터를 주입했을 때 Modified, Untracked, Staged 그룹으로 정확히 분류되는지 확인
- **선택 로직**
    - [ ] `next_selectable`: 헤더(예: `< Modified >`)를 건너뛰고 실제 파일 항목만 선택되는지 확인
    - [ ] 파일이 하나도 없을 때 에러 처리가 정상적으로 이루어지는지 확인

## 5. 즐겨찾기 목록 화면 (RegListState)
다중 저장소 상태 관리 및 필터링을 테스트합니다.

- **필터링**
    - [ ] 등록된 이름(names)이나 경로(path) 조각으로 검색했을 때 올바른 저장소가 필터링되는지 확인
- **상태 전이 (Pull Logic)**
    - [ ] `PullStatus`: Pending -> Running -> Done (OK/ERR)으로 상태 값이 정확히 변경되는지 확인
    - [ ] 병렬 처리 제한(Semaphore)이 논리적으로 올바른지 확인 (직접적인 스레드 테스트 대신 로직 검토)

## 6. 기타 화면 (Find/Grep)
- **FindState**
    - [ ] 명령행 인자(`args`) 파싱 시 `-`로 시작하는 옵션과 경로 인자를 구분하는 로직 확인
- **GrepState**
    - [ ] `focus_line`: 선택된 행에서 파일명과 라인 번호를 정확히 추출하는지 확인
